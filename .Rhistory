C <- matrix(c(0.11, 0.15, 0.23, 0.81, 0.72, 0.92,
0.84, 0.211, 0.95), nrow = 3, ncol = 3)
View(C)
View(C)
I <- matrix(c(0.34, 0.12, 0.25, 0.12, 0.10, 0.14,
0.16, 0.71, 0.82), nrow = 3, ncol = 3)
C*I
C %*% I
sum(C %*% I)
sum(C * I)
View(I)
View(I)
C <- matrix(c(0.11, 0.15, 0.23, 0.81, 0.72, 0.93,
0.84, 0.211, 0.94), nrow = 3, ncol = 3)
I <- matrix(c(0.34, 0.12, 0.25, 0.12, 0.10, 0.14,
0.16, 0.71, 0.82), nrow = 3, ncol = 3)
sum(C * I)
I <- matrix(c(0.34, 0.12, 0.25, 0.21, 0.52, 0.41,
0.12, 0.10, 0.14, 0.26, 0.27, 0.14,
0.16, 0.71, 0.82, 0.99, 0.16, 0.17,
0.14, 0.94, 0.21, 0.98, 0.14, 0.11,
0.18, 0.21, 0.19, 0.23, 0.11, 0.28,
0.17, 0.12, 0.23, 0.15, 0.11, 0.16), nrow = 5, ncol = 5)
I <- matrix(c(0.34, 0.12, 0.25, 0.21, 0.52, 0.41,
0.12, 0.10, 0.14, 0.26, 0.27, 0.14,
0.16, 0.71, 0.82, 0.99, 0.16, 0.17,
0.14, 0.94, 0.21, 0.98, 0.14, 0.11,
0.18, 0.21, 0.19, 0.23, 0.11, 0.28,
0.17, 0.12, 0.23, 0.15, 0.11, 0.16), nrow = 6, ncol = 6)
sum(C * I[1:3, 1:3])
for (i in 1:4) {
sum(C * I[i:(i+2), 1:3])
}
for (i in 1:4) {
sum(C * I[i:(i+2), 1:3])
}
for (i in 1:4) {
print(sum(C * I[i:(i+2), 1:3]))
}
for (i in 1:4) {
for(j in 1:4){
df[i,j] <- sum(C * I[i:(i+2), j:(j+2)])
}
}
df <- matrix(rep(0,16), ncol = 4, nrow = 4)
for (i in 1:4) {
for(j in 1:4){
df[i,j] <- sum(C * I[i:(i+2), j:(j+2)])
}
}
df
knitr::opts_chunk$set(echo = TRUE)
library(tidycensus)
library(tidyverse)
library(ggmap)
library(viridis)
library(leaflet)
library(ZillowR)
library(rgdal)
library(lubridate)
library(scales)
library(lubridate)
#5-year American Community Survey 2015
#Info Here: https://walkerke.github.io/tidycensus/
acs2017Variables <- load_variables(2017, "acs5", cache = TRUE)
load("EDA Data.RData")
leaflet() %>%
addTiles() %>%
addPolygons(data = stJoesTract,
color = "black",
opacity = .6,
weight = 2,
popup = ~NAME,
group = "Census Tract") %>%
addPolygons(data = stJoesBlockGroup,
color = "blue",
opacity = .6,
weight = 2,
popup = ~NAME,
group = "Census Block Group") %>%
addPolygons(data = stJoesZillow,
color = "red",
opacity = .6,
weight = 2,
group = "Zillow") %>%
addLayersControl(
baseGroups = c("Census Tract", "Census Block Group", "Zillow"),
options = layersControlOptions(collapsed = FALSE)
)
populationPal <- colorNumeric("Blues", stJoesTract$`Total PopulationE`)
totalHousingPal <- colorNumeric("Blues", stJoesTract$`Total Housing UnitsE`)
totalRentalUnitsPal <- colorNumeric("Blues", stJoesTract$`Total Renter-Occupied UnitsE`)
incomePal <- colorNumeric("Blues", stJoesTract$`Med Family IncomeE`)
housingCostPal <- colorNumeric("Blues", stJoesTract$`Med Monthly Housing CostsE`)
rentIncomePal <- colorNumeric("Blues", stJoesTract$`Med Rent/Income%E`)
mapPopup <- paste0("<b>",
stJoesTract$NAME,
"</b><br>Total Population: ",
stJoesTract$`Total PopulationE`,
"<br>Total Housing Units: ",
stJoesTract$`Total Housing UnitsE`,
"<br> Median Family Income: $",
stJoesTract$`Med Family IncomeE`,
"<br>Total Rental Units: ",
stJoesTract$`Total Renter-Occupied UnitsE`,
"<br>Median Monthly Housing Costs: $",
stJoesTract$`Med Monthly Housing CostsE`,
"<br>Median Percent of Income Spent on Rent: ",
stJoesTract$`Med Rent/Income%E`, "%")
leaflet() %>%
addTiles() %>%
addPolygons(data = stJoesTract,
color = ~populationPal(`Total PopulationE`),
opacity = .6,
weight = 2,
popup = mapPopup,
group = "Total Population") %>%
addLegend(title = "Population",
position = "bottomleft",
pal = populationPal,
values = stJoesTract$`Total PopulationE`,
group = "Total Population") %>%
addPolygons(data = stJoesTract,
color = ~totalHousingPal(`Total Housing UnitsE`),
opacity = .6,
weight = 2,
popup = mapPopup,
group = "Total Housing Units") %>%
addLegend(title = "Housing Units",
position = "bottomleft",
pal = totalHousingPal,
values = stJoesTract$`Total Housing UnitsE`,
group = "Total Housing Units") %>%
addPolygons(data = stJoesTract,
color = ~incomePal(`Med Family IncomeE`),
opacity = .6,
weight = 2,
popup = mapPopup,
group = "Median Family Income") %>%
addLegend(title = "Family Income",
position = "bottomleft",
pal = incomePal,
values = stJoesTract$`Med Family IncomeE`,
group = "Median Family Income") %>%
addPolygons(data = stJoesTract,
color = ~totalRentalUnitsPal(`Total Renter-Occupied UnitsE`),
opacity = .6,
weight = 2,
popup = mapPopup,
group = "Total Rental Units") %>%
addLegend(title = "Rental Units",
position = "bottomleft",
pal = totalRentalUnitsPal,
values = stJoesTract$`Total Renter-Occupied UnitsE`,
group = "Total Rental Units") %>%
addPolygons(data = stJoesTract,
color = ~housingCostPal(`Med Monthly Housing CostsE`),
opacity = .6,
weight = 2,
popup = mapPopup,
group = "Median Housing Costs") %>%
addLegend(title = "Housing Costs",
position = "bottomleft",
pal = housingCostPal,
values = stJoesTract$`Med Monthly Housing CostsE`,
group = "Median Housing Costs") %>%
addPolygons(data = stJoesTract,
color = ~rentIncomePal(`Med Rent/Income%E`),
opacity = .6,
weight = 2,
popup = mapPopup,
group = "Median Rent/Income") %>%
addLegend(title = "Rent/Income",
position = "bottomleft",
pal = rentIncomePal,
values = stJoesTract$`Med Rent/Income%E`,
group = "Median Rent/Income") %>%
addLayersControl(
overlayGroups = c("Total Population", "Total Housing Units", "Median Family Income", "Total Rental Units",
"Median Housing Costs", "Median Rent/Income"),
options = layersControlOptions(collapsed = FALSE)
) %>%
hideGroup(c("Total Housing Units", "Median Family Income", "Total Rental Units", "Median Housing Costs",
"Median Rent/Income"))
mortgageCosts <- stJoesTract %>%
select(-geometry) %>%
as.tibble() %>%
select(NAME, `Med Owner Costs-MortgageE`, `Med Owner Costs-No MortgageE`) %>%
gather(key = "Mortgage Status", value = "Cost", `Med Owner Costs-MortgageE`:`Med Owner Costs-No MortgageE`) %>%
mutate(`Mortgage Status` = ifelse(`Mortgage Status` == "Med Owner Costs-MortgageE", "Mortgage", "No Mortgage"))
ggplot(
data = mortgageCosts,
aes(x = `Mortgage Status`, y = Cost)
) + geom_boxplot() + labs(x = "Mortgage Status",
title = "Monthly Home Ownership Costs") +
scale_y_continuous(labels = dollar_format())
neighborhoodRent <- read.csv("C:/Users/kost1/Documents/GitHub/DS-Now-Final-Project/Data Sources/Neighborhood Rent Prices-Zillow.csv",
stringsAsFactors = F) %>%
filter(State == "IN") %>%
filter(CountyName == "Saint Joseph County")
longRentZillow <- neighborhoodRent %>%
gather(key = DateString,
value = "ZRI",
-c(RegionID, RegionName, City, State, Metro, CountyName, SizeRank))
tidyRentZillow <- longRentZillow %>%
mutate(DateString = str_sub(DateString, start = 2)) %>%
mutate(Date = as.Date(paste0(DateString, ".1"), "%Y.%m.%d") + months(1) - days(1))
ggplot(
data = tidyRentZillow,
aes(x = Date, y = ZRI, color = RegionName)
) + geom_point() + scale_y_continuous(labels = dollar_format()) +
labs(x = "Date", y = "Zillow Rent Index",
title = "Rent Over Time in South Bend Neighborhoods")
# Plot change over time, by state.
ggplot(
data = tidyRentZillow %>%
mutate(Month = factor(month(Date))),
aes(y = fct_rev(RegionName), x = ZRI)) +
labs(title = "Zillow | South Bend Rent Prices",
subtitle = "2010 - 2017",
x = "", y = "",
colour = "#E0E0E0") +
geom_point(shape = 20, alpha = 0.6, size = 5, aes(color = Month)) +
scale_color_discrete(l = 45, h = c(30, 330)) +
theme(axis.ticks.y = element_blank(),
plot.title = element_text(size = 15, face = c("bold","italic")),
axis.text.x = element_text(size = 9),
axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10),
legend.position = "none",
plot.subtitle = element_text(size = 10),
plot.background = element_rect(fill = "white"), # background color
panel.grid.major.y = element_line(color = "#E0E0E0"), # horizontal line color
panel.background = element_rect(fill = "white")) +
scale_x_continuous(breaks = waiver()) #sets # of labels on x axis
homeValueIndex <- read.csv("C:/Users/kost1/Documents/GitHub/DS-Now-Final-Project/Data Sources/Zillow Home Value Index - All Homes.csv",
stringsAsFactors = F) %>%
filter(State == "IN") %>%
filter(CountyName == "Saint Joseph County")
longValueZillow <- homeValueIndex %>%
gather(key = DateString,
value = "ZHVI",
-c(RegionID, RegionName, City, State, Metro, CountyName, SizeRank))
tidyValueZillow <- longValueZillow %>%
mutate(DateString = str_sub(DateString, start = 2)) %>%
mutate(Date = as.Date(paste0(DateString, ".1"), "%Y.%m.%d") + months(1) - days(1))
ggplot(
data = tidyValueZillow,
aes(x = Date, y = ZHVI, color = RegionName)
) + geom_point() + scale_y_continuous(labels = dollar_format()) +
labs(x = "Date", y = "Zillow Home Value Index",
title = "Home Values Over Time in South Bend Neighborhoods")
homeSales <- read.csv("C:/Users/kost1/Documents/GitHub/DS-Now-Final-Project/Data Sources/Sale_Counts_Seas_Adj_City.csv",
stringsAsFactors = F) %>%
filter(StateName == "Indiana") %>%
filter(RegionName == "South Bend")
longSalesZillow <- homeSales %>%
gather(key = DateString,
value = "Homes Sold",
-c(RegionID, RegionName, StateName, SizeRank))
tidySalesZillow <- longSalesZillow %>%
mutate(DateString = str_sub(DateString, start = 2)) %>%
mutate(Date = as.Date(paste0(DateString, ".1"), "%Y.%m.%d") + months(1) - days(1))
ggplot(
data = na.omit(tidySalesZillow),
aes(x = Date, y = `Homes Sold`)
) + geom_point() +
labs(x = "Date", y = "Homes",
title = "Homes Sold Over Time in South Bend")
bottomTier <- read.csv("C:/Users/kost1/Documents/GitHub/DS-Now-Final-Project/Data Sources/City/City_Zhvi_BottomTier.csv",
stringsAsFactors = F) %>%
filter(State == "IN") %>%
filter(Metro == "South Bend-Mishawaka")
middleTier <- read.csv("C:/Users/kost1/Documents/GitHub/DS-Now-Final-Project/Data Sources/City/City_Zhvi_MiddleTier.csv",
stringsAsFactors = F) %>%
filter(State == "IN") %>%
filter(Metro == "South Bend-Mishawaka")
topTier <- read.csv("C:/Users/kost1/Documents/GitHub/DS-Now-Final-Project/Data Sources/City/City_Zhvi_TopTier.csv",
stringsAsFactors = F) %>%
filter(State == "IN") %>%
filter(Metro == "South Bend-Mishawaka")
bottomZillow <- bottomTier %>%
gather(key = DateString,
value = "Zillow Housing Value Index",
-c(RegionID, RegionName, State, Metro, CountyName, SizeRank))
tidyBottomZillow <- bottomZillow %>%
mutate(DateString = str_sub(DateString, start = 2)) %>%
mutate(Date = as.Date(paste0(DateString, ".1"), "%Y.%m.%d") + months(1) - days(1))
ggplot(
data = na.omit(tidyBottomZillow),
aes(x = Date, y = `Zillow Housing Value Index`, color = RegionName)
) + geom_point() + scale_y_continuous(labels = dollar_format()) +
labs(x = "Date", y = "Zillow Housing Value Index",
title = "Bottom Tier Housing Values\nOver Time in South Bend Area",
color = "City")
2100*12*10
setwd("~/GitHub/DS-Now-Final-Project")
library(tidycensus)
library(tidyverse)
#5-year American Community Survey 2015
#Info Here: https://walkerke.github.io/tidycensus/
acs2017Variables <- load_variables(2017, "acs5", cache = TRUE)
View(acs2017Variables)
View(acs2017Variables)
?qnorm
pnorm(1.96)
pnorm(7/5)
pnorm(7/5)/20
dnorm(7/5)
dnorm(5)
100/1000000
100/1000000 * 10000
qnorm(3)
pnorm(3)
1-pnorm(3)
p3 <- 1-pnorm(3)
p3*365
p3*365/6
library(tidycensus)
censusVars <- c(
`Total Population` = "B01003_001",
`Total Housing Units` = "B25001_001",
`Total Occupied Housing Units` = "B25002_002",
`Total Vacant Housing Units` = "B25002_003",
`Total Owner-Occupied Units` = "B25003_002",
`Total Renter-Occupied Units` = "B25003_003",
`Total For-Rent Units` = "B25004_002",
`Total Rented Non-Occ Units` = "B25004_003",
`Total For-Sale Units` = "B25004_004",
`Total Sold Non-Occ Units` = "B25004_005",
`Med Rent/Income%` = "B25071_001",
`25% Owner Occ Housing Val` = "B25076_001",
`50% Owner Occ Housing Val` = "B25077_001",
`75% Owner Occ Housing Val` = "B25078_001",
`Med Owner Costs-Mortgage` = "B25088_002",
`Med Owner Costs-No Mortgage` = "B25088_003",
`Med Costs/Income%-Mortgage` = "B25092_002",
`Med Costs/Income%-No Mortgage` = "B25092_003",
`Med Monthly Housing Costs` = "B25105_001",
`Med Family Income` = "B19113_001",
`Med Rent-No Bedrooms` = "B25031_002",
`Med Rent-1 Bedroom` = "B25031_003",
`Med Rent-2 Bedrooms` = "B25031_004",
`Med Rent-3 Bedrooms` = "B25031_005",
`Med Rent-4 Bedrooms` = "B25031_006",
`Med Rent-5+ Bedrooms` = "B25031_007",
`Med Rent` = "B25064_001"
)
stJoesBlockGroup <- get_acs(
geography = "block group",
variables = censusVars,
state = "IN",
county = "St. Joseph County",
output = "wide",
geometry = TRUE
)
censusVars <- c(
`Total Population` = "B01003_001",
`Total Housing Units` = "B25001_001",
`Total Occupied Housing Units` = "B25002_002",
`Total Vacant Housing Units` = "B25002_003",
`Total Owner-Occupied Units` = "B25003_002",
`Total Renter-Occupied Units` = "B25003_003",
`Total For-Rent Units` = "B25004_002",
`Total Rented Non-Occ Units` = "B25004_003",
`Total For-Sale Units` = "B25004_004",
`Total Sold Non-Occ Units` = "B25004_005",
`Med Rent/Income%` = "B25071_001",
`25% Owner Occ Housing Val` = "B25076_001",
`50% Owner Occ Housing Val` = "B25077_001",
`75% Owner Occ Housing Val` = "B25078_001",
`Med Owner Costs-Mortgage` = "B25088_002",
`Med Owner Costs-No Mortgage` = "B25088_003",
`Med Costs/Income%-Mortgage` = "B25092_002",
`Med Costs/Income%-No Mortgage` = "B25092_003",
`Med Monthly Housing Costs` = "B25105_001",
`Med Family Income` = "B19113_001",
`Med Rent-No Bedrooms` = "B25031_002",
`Med Rent-1 Bedroom` = "B25031_003",
`Med Rent-2 Bedrooms` = "B25031_004",
`Med Rent-3 Bedrooms` = "B25031_005",
`Med Rent-4 Bedrooms` = "B25031_006",
`Med Rent-5+ Bedrooms` = "B25031_007",
`Med Rent` = "B25064_001"
)
stJoesBlockGroup <- get_acs(
geography = "block group",
variables = censusVars,
state = "IN",
county = "St. Joseph County",
output = "wide",
geometry = TRUE
)
tidycensus::census_api_key("aca156af3668f91e83aa2ef537451d708acf4838", install = T)
stJoesBlockGroup <- get_acs(
geography = "block group",
variables = censusVars,
state = "IN",
county = "St. Joseph County",
output = "wide",
geometry = TRUE
)
