---
title: "Exploratory Data Analysis"
author: "Joe Kosteck"
date: "February 13, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Exploratory Data Analysis

```{r}
library(tidycensus)
library(tidyverse)
library(ggmap)
library(viridis)
library(leaflet)
library(ZillowR)
library(rgdal)
```

```{r}
#5-year American Community Survey 2015
#Info Here: https://walkerke.github.io/tidycensus/
acs2017Variables <- load_variables(2017, "acs5", cache = TRUE)
```

```{r}
censusVars <- c(
  totalPopulation = "B01003_001",
  rentPortion = "B25072_001",
  ownerUnits = "B25106_002",
  rentalUnits = "B25106_024",
  `Total Gross Rent` = 'B25063_001',
  `Total Gross Cash Rent` = 'B25063_002',
  `CashRent < 100` = 'B25063_003',
  `CashRent 100-149` = 'B25063_004',
  `CashRent 150-199` = 'B25063_005',
  `CashRent 200-149` = 'B25063_006',
  `CashRent 250-299` = 'B25063_007',
  `CashRent 300-349` = 'B25063_008',
  `CashRent 350-399` = 'B25063_009',
  `CashRent 400-449` = 'B25063_010',
  `CashRent 450-499` = 'B25063_011',
  `CashRent 500-549` = 'B25063_012',
  `CashRent 550-599` = 'B25063_013',
  `CashRent 600-649` = 'B25063_014',
  `CashRent 650-699` = 'B25063_015',
  `CashRent 700-749` = 'B25063_016',
  `CashRent 750-799` = 'B25063_017',
  `CashRent 800-899` = 'B25063_018',
  `CashRent 900-999` = 'B25063_019',
  `CashRent 1000-1249` = 'B25063_020',
  `CashRent 1250-1499` = 'B25063_021',
  `CashRent 1500-1999` = 'B25063_022',
  `CashRent 2000-2499` = 'B25063_023',
  `CashRent 2500-2999` = 'B25063_024',
  `CashRent 3000-3499` = 'B25063_025',
  `CashRent > 3500` = 'B25063_026',
  `CashRent 0` = 'B25063_027')

stJoesTract <- get_acs(
  geography = "tract",
  variables = censusVars,
  state = "IN",
  county = "St. Joseph County",
  output = "wide",
  geometry = TRUE
)


stJoesBlockGroup <- get_acs(
  geography = "block group",
  variables = censusVars,
  state = "IN",
  county = "St. Joseph County",
  output = "wide",
  geometry = TRUE
)

stJoesTract <- sf::st_transform(stJoesTract, 4326)
stJoesBlockGroup <- sf::st_transform(stJoesBlockGroup, 4326)
```

```{r}
zillowNeighborhoods <- readOGR(dsn = "C:/Users/kost1/Documents/GitHub/DS-Now-Final-Project/Data Sources",
                               layer = "ZillowNeighborhoods-IN",
                               stringsAsFactors = F)
```

```{r}
stJoesZillow <- zillowNeighborhoods[zillowNeighborhoods$County == "Saint Joseph", ]
````

```{r}
leaflet() %>%
  addTiles() %>%
  addPolygons(data = stJoesTract,
              color = "black",
              opacity = .6,
              weight = 2,
              fill = FALSE,
              popup = ~NAME,
              group = "Census Tract") %>%
  addPolygons(data = stJoesBlockGroup,
              color = "blue",
              opacity = .6,
              weight = 2,
              fill = FALSE,
              popup = ~NAME,
              group = "Census Block Group") %>%
  addPolygons(data = stJoesZillow,
              color = "red",
              opacity = .6,
              weight = 2,
              fill = FALSE,
              group = "Zillow") %>%
  addLayersControl(
    baseGroups = c("Census Tract", "Census Block Group", "Zillow"),
    options = layersControlOptions(collapsed = FALSE)
  )
```