---
title: "Final Deliverable"
author: "Joe Kosteck"
date: "March 25, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, warning=FALSE, echo=FALSE, message=FALSE}
setwd("~/GitHub/DS-Now-Final-Project/Final Deliverables")

library(tidycensus)
library(tidyverse)
library(leaflet)
library(rgdal)
library(DT)
library(rgeos)
library(sf)
library(knitr)
library(kableExtra)

load("cluster data for analysis.RData")
load("census_shapefiles.RData")
```

```{r, echo=FALSE, message=FALSE, results='hide'}
neighborhoods <- readOGR("./South_Bend_Active_Neighborhoods_Map",
                         layer = "Neighborhood_Boundaries-polygon",
                         stringsAsFactors = F)

neighborhoods$Name <- str_remove_all(neighborhoods$Name, "Â")

city_limits <- readOGR("./South_Bend_Active_Neighborhoods_Map",
                       layer = "City_Limits",
                       stringsAsFactors = F)
```
#County-wide Block Group Data
The maps and data tables below show data related to all the block groups in St. Joseph's county.

##Variables Included in this Analysis
```{r, echo=FALSE}
col_name_array <- array(c("Population",
                          "Housing Units",
                          "Occupied Housing Units",
                          "Vacant Housing Units",
                          "Owner-Occupied Units",
                          "Renter-Occupied Units",
                          "Units for Rent",
                          "Rented, Non-Occupied Units",
                          "Units for Sale",
                          "Sold, Non-Occupied Units",
                          "25th Percentile Home Value",
                          "50th Percentile Home Value",
                          "75th Percentile Home Value",
                          "Median Owner Cost - Mortgage",
                          "Median Owner Cost - No Mortgage",
                          "Median Owner Cost/Income - Mortgage",
                          "Median Owner Cost/Income - No Mortgage",
                          "Median Family Income",
                          "White Population",
                          "Black Population",
                          "Native American Population",
                          "Asian Population",
                          "Pacific Islander Population",
                          "Other Population",
                          "Two or More Races Population",
                          "Median Age",
                          "Median Age - Male",
                          "Median Age - Female",
                          "Households",
                          "Family Households",
                          "Family Households - Married",
                          "Family Households - Other",
                          "Non-family Households",
                          "Non-family Households - Alone",
                          "Non-family Households - Not Alone",
                          "Two Person Families",
                          "Three Person Families",
                          "Four Person Families",
                          "Five Person Families",
                          "Six Person Families",
                          "7 or More Person Families",
                          "1 Person Non-families",
                          "2 Person Non-families",
                          "3 Person Non-families",
                          "4 Person Non-families",
                          "5 Person Non-families",
                          "6 Person Non-families",
                          "7 or More Person Non-families",
                          "Labor Force",
                          "Civilian Labor Force",
                          "Civilian Labor Force - Employed",
                          "Civilian Labor Force - Unemployed",
                          "Military Labor Force",
                          "Non-Labor Force",
                          "Education - No Schooling",
                          "Education - Nursery School",
                          "Education - Kindergarten",
                          "Education - First Grade",
                          "Education - Second Grade",
                          "Education - Third Grade",
                          "Education - Fourth Grade",
                          "Education - Fifth Grade",
                          "Education - Sixth Grade",
                          "Education - Seventh Grade",
                          "Education - Eighth Grade",
                          "Education - Ninth Grade",
                          "Education - Tenth Grade",
                          "Education - Eleventh Grade",
                          "Education - Twelfth Grade - No Diploma",
                          "Education - High School Diploma",
                          "Education - GED or Alternative",
                          "Education - Less Than 1 Year College",
                          "Education - More Than 1 Year Collage - No Degree",
                          "Education - Associates Degree",
                          "Education - Bachelors Degree",
                          "Education - Masters Degree",
                          "Education - Professional School Degree",
                          "Education - Doctorate Degree",
                          "Commute - Car, Truck or Van",
                          "Commute - Drive Alone",
                          "Commute - Carpool",
                          "Commute - 2 Person Carpool",
                          "Commute - 3 Person Carpool",
                          "Commute - 4 Person Carpool",
                          "Commute - 5 or 6 Person Carpool",
                          "Commute - 7 or More Person Carpool",
                          "Commute - Public Transportation",
                          "Commute - Bus or Trolley",
                          "Commute - Subway or Elevated Train",
                          "Commute - Railroad Train",
                          "Commute - Ferry Boat",
                          "Commute - Taxi",
                          "Commute - Motorcycle",
                          "Commute - Bicycle",
                          "Commute - Walk",
                          "Commute - Other Means",
                          "Commute - Work from Home",
                          "Household Income - Less than $10,000",
                          "Household Income - $10,000 - $14,999",
                          "Household Income - $15,000 - $19,999",
                          "Household Income - $20,000 - $24,999",
                          "Household Income - $25,000 - $29,999",
                          "Household Income - $30,000 - $34,999",
                          "Household Income - $35,000 - $39,999",
                          "Household Income - $40,000 - $44,999",
                          "Household Income - $45,000 - $49,999",
                          "Household Income - $50,000 - $59,999",
                          "Household Income - $60,000 - $74,999",
                          "Household Income - $75,000 - $99,999",
                          "Household Income - $100,000 - $124,999",
                          "Household Income - $125,000 - $149,999",
                          "Household Income - $150,000 - $199,999",
                          "Household Income - $200,000 or More",
                          "Median Rent/Income",
                          "Median Housing Cost",
                          "Median Non-family Income",
                          "Median Rent - No Bedrooms",
                          "Median Rent - 1 Bedroom",
                          "Median Rent - 2 Bedrooms",
                          "Median Rent - 3 Bedrooms",
                          "Median Rent - 4 Bedrooms",
                          "Median Rent - 5 or More Bedrooms",
                          "Median Rent",
                          "Aggregate Income Deficit",
                          "Aggregate Income Deficit - Married",
                          "Aggregate Income Deficit - Nonmarried",
                          "Aggregate Income Deficit - No Wife",
                          "Aggregate Income Deficit - No Husband",
                          "Median Household Income",
                          "Median Household Income - Owners",
                          "Median Household Income - Renters",
                          "Commute - Streetcar or Trolley Car",
                          "Empolyed - No Vehicles Available",
                          "Empolyed - 1 Vehicle Available",
                          "Empolyed - 2 Vehicles Available",
                          "Empolyed - 3 Vehicles Available",
                          "Empolyed - 4 Vehicles Available",
                          "Empolyed - 5 Vehicles Available"), dim = c(35, 4))

col_name_array[34:35, 4] <- ""

kable(col_name_array, col.names = rep("", 4), row.names = F) %>%
  kable_styling()
```

##Interactive Block Group and Neighborhood Map
The map below shows the boundaries of the census Block Groups, colored by their profile. Additionally, neighborhood boundaries from the South Bend Neighborhood Resources Connection.
```{r, echo=FALSE, warning=FALSE}
block_shapes_profile <- block_shapes %>%
  inner_join(minus_margins_block, by = "NAME") %>%
  select(NAME, `Block Group`, `Census Tract`,
         Profile = cluster, geometry)

profile_block_pal <- colorFactor("Dark2", block_shapes$Profile)
profile_colors <- profile_block_pal(1:5)

block_shapes_profile$`Block Group` <- str_remove(block_shapes_profile$`Block Group`,
                                                 "Block Group ")

block_shapes_profile$`Census Tract` <- str_remove(block_shapes_profile$`Census Tract`,
                                                  "Census Tract ")

block_shapes_profile$name_popup <- paste0("<b>Profile: </b>",
                                          block_shapes_profile$Profile,
                                          "<br><b>Census Tract: </b>",
                                          block_shapes_profile$`Census Tract`,
                                          "<br><b>Block Group: </b>",
                                          block_shapes_profile$`Block Group`)

leaflet() %>%
  addTiles() %>%
  addPolygons(data = block_shapes_profile[block_shapes_profile$Profile == 1,],
              color = profile_colors[1],
              fillOpacity = .75,
              opacity = 1,
              popup = ~name_popup,
              group = "Profile 1") %>%
  addPolygons(data = block_shapes_profile[block_shapes_profile$Profile == 2,],
              color = profile_colors[2],
              fillOpacity = .75,
              opacity = 1,
              popup = ~name_popup,
              group = "Profile 2") %>%
  addPolygons(data = block_shapes_profile[block_shapes_profile$Profile == 3,],
              color = profile_colors[3],
              fillOpacity = .75,
              opacity = 1,
              popup = ~name_popup,
              group = "Profile 3") %>%
  addPolygons(data = block_shapes_profile[block_shapes_profile$Profile == 4,],
              color = profile_colors[4],
              fillOpacity = .75,
              opacity = 1,
              popup = ~name_popup,
              group = "Profile 4") %>%
  addPolygons(data = block_shapes_profile[block_shapes_profile$Profile == 5,],
              color = profile_colors[5],
              fillOpacity = .75,
              opacity = 1,
              popup = ~name_popup,
              group = "Profile 5") %>%
  addPolygons(data = city_limits,
              color = "black",
              fillOpacity = 0,
              opacity = 1,
              weight = 2,
              group = "City Limits") %>%
  addPolygons(data = neighborhoods,
              color = "black",
              fillOpacity = .4,
              opacity = 1,
              weight = 2,
              group = "Neighborhoods",
              label = ~Name) %>%
  addLegend(pal = profile_block_pal,
            values = block_shapes_profile$Profile) %>%
  addLayersControl(overlayGroups = c("Profile 1", "Profile 2", "Profile 3",
                                     "Profile 4", "Profile 5", "Neighborhoods",
                                     "City Limits"),
                   options = layersControlOptions(collapsed = FALSE),
                   position = "topleft")
```

##Average Values for Each Profile
Below, the data table shows the average values of the Block Groups that are contained within each profile.
```{r, echo=FALSE}
transposed_center_block <- as.data.frame(t(unscaled_centers_block))
colnames(transposed_center_block) <- paste0("Profile ", 1:5)
transposed_center_block <- round(transposed_center_block, 2)
transposed_center_block <- transposed_center_block[-1, ]
rownames(transposed_center_block) <- c("Average Population",
                                       "Average Housing Units",
                                       "Average Occupied Housing Units",
                                       "Average Vacant Housing Units",
                                       "Average Owner-Occupied Units",
                                       "Average Renter-Occupied Units",
                                       "Average Units for Rent",
                                       "Average Rented, Non-Occupied Units",
                                       "Average Units for Sale",
                                       "Average Sold, Non-Occupied Units",
                                       "25th Percentile Home Value",
                                       "50th Percentile Home Value",
                                       "75th Percentile Home Value",
                                       "Median Owner Cost - Mortgage",
                                       "Median Owner Cost - No Mortgage",
                                       "Median Owner Cost/Income - Mortgage",
                                       "Median Owner Cost/Income - No Mortgage",
                                       "Median Family Income",
                                       "Average White Population",
                                       "Average Black Population",
                                       "Average Native American Population",
                                       "Average Asian Population",
                                       "Average Pacific Islander Population",
                                       "Average Other Population",
                                       "Average Two or More Races Population",
                                       "Median Age",
                                       "Median Age - Male",
                                       "Median Age - Female",
                                       "Average Households",
                                       "Family Households",
                                       "Family Households - Married",
                                       "Family Households - Other",
                                       "Non-family Households",
                                       "Non-family Households - Alone",
                                       "Non-family Households - Not Alone",
                                       "Two Person Families",
                                       "Three Person Families",
                                       "Four Person Families",
                                       "Five Person Families",
                                       "Six Person Families",
                                       "7 or More Person Families",
                                       "1 Person Non-families",
                                       "2 Person Non-families",
                                       "3 Person Non-families",
                                       "4 Person Non-families",
                                       "5 Person Non-families",
                                       "6 Person Non-families",
                                       "7 or More Person Non-families",
                                       "Average Labor Force",
                                       "Civilian Labor Force",
                                       "Civilian Labor Force - Employed",
                                       "Civilian Labor Force - Unemployed",
                                       "Military Labor Force",
                                       "Non-Labor Force",
                                       "Education - No Schooling",
                                       "Education - Nursery School",
                                       "Education - Kindergarten",
                                       "Education - First Grade",
                                       "Education - Second Grade",
                                       "Education - Third Grade",
                                       "Education - Fourth Grade",
                                       "Education - Fifth Grade",
                                       "Education - Sixth Grade",
                                       "Education - Seventh Grade",
                                       "Education - Eighth Grade",
                                       "Education - Ninth Grade",
                                       "Education - Tenth Grade",
                                       "Education - Eleventh Grade",
                                       "Education - Twelfth Grade - No Diploma",
                                       "Education - High School Diploma",
                                       "Education - GED or Alternative",
                                       "Education - Less Than 1 Year College",
                                       "Education - More Than 1 Year Collage - No Degree",
                                       "Education - Associates Degree",
                                       "Education - Bachelors Degree",
                                       "Education - Masters Degree",
                                       "Education - Professional School Degree",
                                       "Education - Doctorate Degree",
                                       "Commute - Car, Truck or Van",
                                       "Commute - Drive Alone",
                                       "Commute - Carpool",
                                       "Commute - 2 Person Carpool",
                                       "Commute - 3 Person Carpool",
                                       "Commute - 4 Person Carpool",
                                       "Commute - 5 or 6 Person Carpool",
                                       "Commute - 7 or More Person Carpool",
                                       "Commute - Public Transportation",
                                       "Commute - Bus or Trolley",
                                       "Commute - Subway or Elevated Train",
                                       "Commute - Railroad Train",
                                       "Commute - Ferry Boat",
                                       "Commute - Taxi",
                                       "Commute - Motorcycle",
                                       "Commute - Bicycle",
                                       "Commute - Walk",
                                       "Commute - Other Means",
                                       "Commute - Work from Home",
                                       "Household Income - Less than $10,000",
                                       "Household Income - $10,000 - $14,999",
                                       "Household Income - $15,000 - $19,999",
                                       "Household Income - $20,000 - $24,999",
                                       "Household Income - $25,000 - $29,999",
                                       "Household Income - $30,000 - $34,999",
                                       "Household Income - $35,000 - $39,999",
                                       "Household Income - $40,000 - $44,999",
                                       "Household Income - $45,000 - $49,999",
                                       "Household Income - $50,000 - $59,999",
                                       "Household Income - $60,000 - $74,999",
                                       "Household Income - $75,000 - $99,999",
                                       "Household Income - $100,000 - $124,999",
                                       "Household Income - $125,000 - $149,999",
                                       "Household Income - $150,000 - $199,999",
                                       "Household Income - $200,000 or More",
                                       "Median Rent/Income",
                                       "Median Housing Cost",
                                       "Median Non-family Income",
                                       "Median Rent - No Bedrooms",
                                       "Median Rent - 1 Bedroom",
                                       "Median Rent - 2 Bedrooms",
                                       "Median Rent - 3 Bedrooms",
                                       "Median Rent - 4 Bedrooms",
                                       "Median Rent - 5 or More Bedrooms",
                                       "Median Rent",
                                       "Aggregate Income Deficit",
                                       "Aggregate Income Deficit - Married",
                                       "Aggregate Income Deficit - Nonmarried",
                                       "Aggregate Income Deficit - No Wife",
                                       "Aggregate Income Deficit - No Husband",
                                       "Median Household Income",
                                       "Median Household Income - Owners",
                                       "Median Household Income - Renters",
                                       "Commute - Streetcar or Trolley Car",
                                       "Empolyed - No Vehicles Available",
                                       "Empolyed - 1 Vehicle Available",
                                       "Empolyed - 2 Vehicles Available",
                                       "Empolyed - 3 Vehicles Available",
                                       "Empolyed - 4 Vehicles Available",
                                       "Empolyed - 5 Vehicles Available")
```

```{r, echo=FALSE}
datatable(transposed_center_block)
```
##Total Values for Each Profile
Below, the data table shows the total values of the Block Groups that are contained within each profile.
```{r, echo=FALSE}
total_profile_values <- imputed_block %>%
  select(-contains("median"),
         -starts_with("med"), -starts_with("owner_hous_val")) %>%
  rename(Profile = cluster) %>%
  group_by(Profile) %>%
  select_if(is.numeric) %>%
  summarise_all(sum)

transposed_profile_sums <- as.data.frame(t(total_profile_values))[-1, ]
colnames(transposed_profile_sums) <- paste0("Profile ", 1:5)

rownames(transposed_profile_sums) <- c("Total Population",
                                       "Total Housing Units",
                                       "Total Occupied Housing Units",
                                       "Total Vacant Housing Units",
                                       "Total Owner-Occupied Units",
                                       "Total Renter-Occupied Units",
                                       "Total Units for Rent",
                                       "Total Rented, Non-Occupied Units",
                                       "Total Units for Sale",
                                       "Total Sold, Non-Occupied Units",
                                       "Total White Population",
                                       "Total Black Population",
                                       "Total Native American Population",
                                       "Total Asian Population",
                                       "Total Pacific Islander Population",
                                       "Total Other Population",
                                       "Total Two or More Races Population",
                                       "Total Households",
                                       "Family Households",
                                       "Family Households - Married",
                                       "Family Households - Other",
                                       "Non-family Households",
                                       "Non-family Households - Alone",
                                       "Non-family Households - Not Alone",
                                       "Two Person Families",
                                       "Three Person Families",
                                       "Four Person Families",
                                       "Five Person Families",
                                       "Six Person Families",
                                       "7 or More Person Families",
                                       "1 Person Non-families",
                                       "2 Person Non-families",
                                       "3 Person Non-families",
                                       "4 Person Non-families",
                                       "5 Person Non-families",
                                       "6 Person Non-families",
                                       "7 or More Person Non-families",
                                       "Total Labor Force",
                                       "Civilian Labor Force",
                                       "Civilian Labor Force - Employed",
                                       "Civilian Labor Force - Unemployed",
                                       "Military Labor Force",
                                       "Non-Labor Force",
                                       "Education - No Schooling",
                                       "Education - Nursery School",
                                       "Education - Kindergarten",
                                       "Education - First Grade",
                                       "Education - Second Grade",
                                       "Education - Third Grade",
                                       "Education - Fourth Grade",
                                       "Education - Fifth Grade",
                                       "Education - Sixth Grade",
                                       "Education - Seventh Grade",
                                       "Education - Eighth Grade",
                                       "Education - Ninth Grade",
                                       "Education - Tenth Grade",
                                       "Education - Eleventh Grade",
                                       "Education - Twelfth Grade - No Diploma",
                                       "Education - High School Diploma",
                                       "Education - GED or Alternative",
                                       "Education - Less Than 1 Year College",
                                       "Education - More Than 1 Year Collage - No Degree",
                                       "Education - Associates Degree",
                                       "Education - Bachelors Degree",
                                       "Education - Masters Degree",
                                       "Education - Professional School Degree",
                                       "Education - Doctorate Degree",
                                       "Commute - Car, Truck or Van",
                                       "Commute - Drive Alone",
                                       "Commute - Carpool",
                                       "Commute - 2 Person Carpool",
                                       "Commute - 3 Person Carpool",
                                       "Commute - 4 Person Carpool",
                                       "Commute - 5 or 6 Person Carpool",
                                       "Commute - 7 or More Person Carpool",
                                       "Commute - Public Transportation",
                                       "Commute - Bus or Trolley",
                                       "Commute - Subway or Elevated Train",
                                       "Commute - Railroad Train",
                                       "Commute - Ferry Boat",
                                       "Commute - Taxi",
                                       "Commute - Motorcycle",
                                       "Commute - Bicycle",
                                       "Commute - Walk",
                                       "Commute - Other Means",
                                       "Commute - Work from Home",
                                       "Household Income - Less than $10,000",
                                       "Household Income - $10,000 - $14,999",
                                       "Household Income - $15,000 - $19,999",
                                       "Household Income - $20,000 - $24,999",
                                       "Household Income - $25,000 - $29,999",
                                       "Household Income - $30,000 - $34,999",
                                       "Household Income - $35,000 - $39,999",
                                       "Household Income - $40,000 - $44,999",
                                       "Household Income - $45,000 - $49,999",
                                       "Household Income - $50,000 - $59,999",
                                       "Household Income - $60,000 - $74,999",
                                       "Household Income - $75,000 - $99,999",
                                       "Household Income - $100,000 - $124,999",
                                       "Household Income - $125,000 - $149,999",
                                       "Household Income - $150,000 - $199,999",
                                       "Household Income - $200,000 or More")

datatable(transposed_profile_sums)
```
#Neighborhood Block Group Data
Next, geospatial analysis is conducted to find Block Groups that overlap with the Neighborhood Resource Council's defined neighborhoods.

##Neighborhood Map
First, a map of the neighborhoods is created.

##Overlaping Neighborhoods and Block Groups

```{r, echo=FALSE, warning=FALSE}
neighborhoods_sf <- st_as_sf(neighborhoods)
neighborhoods_sf <- st_transform(neighborhoods_sf, st_crs(block_shapes))

intersecting_neighborhoods_sf <- st_intersection(neighborhoods_sf, block_shapes)
intersecting_neighborhoods_df <- as_tibble(intersecting_neighborhoods_sf) %>%
  select(Neighborhood = Name, NAME) %>%
  mutate()

intersecting_neighborhoods_df <- intersecting_neighborhoods_df %>%
  inner_join(minus_margins_block, by = "NAME") %>%
  select(Neighborhood, `Block Group`, `Census Tract`) %>%
  inner_join(imputed_block, by = c("Block Group", "Census Tract")) %>%
  rename(Profile = cluster)

intersecting_neighborhoods_names <- c("Neighborhood",
                                      "Block Group",
                                      "Census Tract",
                                      "Profile",
                                      "Total Population",
                                      "Total Housing Units",
                                      "Total Occupied Housing Units",
                                      "Total Vacant Housing Units",
                                      "Total Owner-Occupied Units",
                                      "Total Renter-Occupied Units",
                                      "Total Units for Rent",
                                      "Total Rented, Non-Occupied Units",
                                      "Total Units for Sale",
                                      "Total Sold, Non-Occupied Units",
                                      "25th Percentile Home Value",
                                      "50th Percentile Home Value",
                                      "75th Percentile Home Value",
                                      "Median Owner Cost - Mortgage",
                                      "Median Owner Cost - No Mortgage",
                                      "Median Owner Cost/Income - Mortgage",
                                      "Median Owner Cost/Income - No Mortgage",
                                      "Median Family Income",
                                      "Total White Population",
                                      "Total Black Population",
                                      "Total Native American Population",
                                      "Total Asian Population",
                                      "Total Pacific Islander Population",
                                      "Total Other Population",
                                      "Total Two or More Races Population",
                                      "Median Age",
                                      "Median Age - Male",
                                      "Median Age - Female",
                                      "Total Households",
                                      "Family Households",
                                      "Family Households - Married",
                                      "Family Households - Other",
                                      "Non-family Households",
                                      "Non-family Households - Alone",
                                      "Non-family Households - Not Alone",
                                      "Two Person Families",
                                      "Three Person Families",
                                      "Four Person Families",
                                      "Five Person Families",
                                      "Six Person Families",
                                      "7 or More Person Families",
                                      "1 Person Non-families",
                                      "2 Person Non-families",
                                      "3 Person Non-families",
                                      "4 Person Non-families",
                                      "5 Person Non-families",
                                      "6 Person Non-families",
                                      "7 or More Person Non-families",
                                      "Average Labor Force",
                                      "Civilian Labor Force",
                                      "Civilian Labor Force - Employed",
                                      "Civilian Labor Force - Unemployed",
                                      "Military Labor Force",
                                      "Non-Labor Force",
                                      "Education - No Schooling",
                                      "Education - Nursery School",
                                      "Education - Kindergarten",
                                      "Education - First Grade",
                                      "Education - Second Grade",
                                      "Education - Third Grade",
                                      "Education - Fourth Grade",
                                      "Education - Fifth Grade",
                                      "Education - Sixth Grade",
                                      "Education - Seventh Grade",
                                      "Education - Eighth Grade",
                                      "Education - Ninth Grade",
                                      "Education - Tenth Grade",
                                      "Education - Eleventh Grade",
                                      "Education - Twelfth Grade - No Diploma",
                                      "Education - High School Diploma",
                                      "Education - GED or Alternative",
                                      "Education - Less Than 1 Year College",
                                      "Education - More Than 1 Year Collage - No Degree",
                                      "Education - Associates Degree",
                                      "Education - Bachelors Degree",
                                      "Education - Masters Degree",
                                      "Education - Professional School Degree",
                                      "Education - Doctorate Degree",
                                      "Commute - Car, Truck or Van",
                                      "Commute - Drive Alone",
                                      "Commute - Carpool",
                                      "Commute - 2 Person Carpool",
                                      "Commute - 3 Person Carpool",
                                      "Commute - 4 Person Carpool",
                                      "Commute - 5 or 6 Person Carpool",
                                      "Commute - 7 or More Person Carpool",
                                      "Commute - Public Transportation",
                                      "Commute - Bus or Trolley",
                                      "Commute - Subway or Elevated Train",
                                      "Commute - Railroad Train",
                                      "Commute - Ferry Boat",
                                      "Commute - Taxi",
                                      "Commute - Motorcycle",
                                      "Commute - Bicycle",
                                      "Commute - Walk",
                                      "Commute - Other Means",
                                      "Commute - Work from Home",
                                      "Household Income - Less than $10,000",
                                      "Household Income - $10,000 - $14,999",
                                      "Household Income - $15,000 - $19,999",
                                      "Household Income - $20,000 - $24,999",
                                      "Household Income - $25,000 - $29,999",
                                      "Household Income - $30,000 - $34,999",
                                      "Household Income - $35,000 - $39,999",
                                      "Household Income - $40,000 - $44,999",
                                      "Household Income - $45,000 - $49,999",
                                      "Household Income - $50,000 - $59,999",
                                      "Household Income - $60,000 - $74,999",
                                      "Household Income - $75,000 - $99,999",
                                      "Household Income - $100,000 - $124,999",
                                      "Household Income - $125,000 - $149,999",
                                      "Household Income - $150,000 - $199,999",
                                      "Household Income - $200,000 or More")

colnames(intersecting_neighborhoods_df) <- intersecting_neighborhoods_names

datatable(intersecting_neighborhoods_df,
          options = list(
            scrollX = T
          )
)
```

```{r, echo=FALSE}
neighborhood_transposed <- intersecting_neighborhoods_df %>%
  group_by(Neighborhood) %>%
  select_if(is.numeric) %>%
  select(-Profile) %>%
  summarise_all(mean) %>%
  t(.) %>%
  as.tibble()

colnames(neighborhood_transposed) <- neighborhood_transposed[1, ]
neighborhood_transposed <- neighborhood_transposed[-1, ]
neighborhood_transposed <- neighborhood_transposed %>%
  mutate_all(as.numeric) %>%
  round(., 3)

rownames(neighborhood_transposed) <- str_replace_all(colnames(intersecting_neighborhoods_df)[-c(1:4)],
                                                     "Total",
                                                     "Average")

datatable(neighborhood_transposed,
          options = list(
            scrollX = TRUE
          ))
```

##Profile 1
```{r, warning=FALSE, echo=FALSE}
leaflet() %>%
  addTiles() %>%
  addPolygons(data = block_shapes_profile[block_shapes_profile$Profile == 1,],
              color = profile_colors[1],
              fillOpacity = .75,
              opacity = 1,
              popup = ~name_popup,
              group = "Profile 1",
              label = "Profile 1")
```

##Profile 2
```{r, warning=FALSE, echo=FALSE}
leaflet() %>%
  addTiles() %>%
  addPolygons(data = block_shapes_profile[block_shapes_profile$Profile == 2,],
              color = profile_colors[2],
              fillOpacity = .75,
              opacity = 1,
              popup = ~name_popup,
              group = "Profile 2",
              label = "Profile 2")
```

##Profile 3
```{r, warning=FALSE, echo=FALSE}
leaflet() %>%
  addTiles() %>%
  addPolygons(data = block_shapes_profile[block_shapes_profile$Profile == 3,],
              color = profile_colors[3],
              fillOpacity = .75,
              opacity = 1,
              popup = ~name_popup,
              group = "Profile 3",
              label = "Profile 3")
```

##Profile 4
```{r, warning=FALSE, echo=FALSE}
leaflet() %>%
  addTiles() %>%
  addPolygons(data = block_shapes_profile[block_shapes_profile$Profile == 4,],
              color = profile_colors[4],
              fillOpacity = .75,
              opacity = 1,
              popup = ~name_popup,
              group = "Profile 4",
              label = "Profile 4")
```

#Profile 5
```{r, warning=FALSE, echo=FALSE}
leaflet() %>%
  addTiles() %>%
  addPolygons(data = block_shapes_profile[block_shapes_profile$Profile == 5,],
              color = profile_colors[5],
              fillOpacity = .75,
              opacity = 1,
              popup = ~name_popup,
              group = "Profile 5",
              label = "Profile 5")
```